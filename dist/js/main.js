!function e(t,a,o){function n(d,p){if(!a[d]){if(!t[d]){var s="function"==typeof require&&require;if(!p&&s)return s(d,!0);if(r)return r(d,!0);throw new Error("Cannot find module '"+d+"'")}var m=a[d]={exports:{}};t[d][0].call(m.exports,function(e){var a=t[d][1][e];return n(a?a:e)},m,m.exports,e,t,a,o)}return a[d].exports}for(var r="function"==typeof require&&require,d=0;d<o.length;d++)n(o[d]);return n}({1:[function(e,t){var a=e("./util.js"),o=function(){var e=a.state,t={"8x8_1":[[e.owned(1),e.empty,e.empty,e.empty,e.empty,e.empty,e.empty,e.dead],[e.dead,e.dead,e.dead,e.dead,e.dead,e.dead,e.dead,e.dead],[e.empty,e.empty,e.empty,e.empty,e.empty,e.empty,e.empty,e.empty],[e.empty,e.empty,e.empty,e.empty,e.empty,e.empty,e.empty,e.dead],[e.dead,e.empty,e.empty,e.empty,e.empty,e.empty,e.empty,e.empty],[e.empty,e.empty,e.empty,e.empty,e.empty,e.empty,e.empty,e.empty],[e.dead,e.dead,e.dead,e.dead,e.dead,e.dead,e.dead,e.dead],[e.dead,e.empty,e.empty,e.empty,e.empty,e.empty,e.empty,e.owned(2)]],"8x8_2":[[e.owned(1),e.dead,e.empty,e.empty,e.dead,e.empty,e.empty,e.dead],[e.dead,e.empty,e.dead,e.empty,e.empty,e.dead,e.dead,e.empty],[e.dead,e.empty,e.dead,e.empty,e.empty,e.empty,e.empty,e.dead],[e.empty,e.dead,e.dead,e.empty,e.empty,e.empty,e.empty,e.dead],[e.dead,e.empty,e.empty,e.empty,e.empty,e.dead,e.dead,e.empty],[e.dead,e.empty,e.empty,e.empty,e.empty,e.dead,e.empty,e.dead],[e.empty,e.dead,e.dead,e.empty,e.empty,e.dead,e.empty,e.dead],[e.dead,e.empty,e.empty,e.dead,e.empty,e.empty,e.dead,e.owned(2)]],"8x8_3":[[e.owned(1),e.empty,e.dead,e.empty,e.empty,e.dead,e.dead,e.empty],[e.dead,e.empty,e.empty,e.empty,e.dead,e.empty,e.empty,e.dead],[e.empty,e.empty,e.empty,e.empty,e.dead,e.empty,e.empty,e.empty],[e.empty,e.empty,e.empty,e.empty,e.empty,e.empty,e.dead,e.empty],[e.empty,e.dead,e.empty,e.empty,e.empty,e.empty,e.empty,e.empty],[e.empty,e.empty,e.empty,e.dead,e.empty,e.empty,e.empty,e.empty],[e.dead,e.empty,e.empty,e.dead,e.empty,e.empty,e.empty,e.dead],[e.empty,e.dead,e.dead,e.empty,e.empty,e.dead,e.empty,e.owned(2)]]},o={"8x8_1":{1:{x:0,y:0},2:{x:7,y:7}},"8x8_2":{1:{x:0,y:0},2:{x:7,y:7}},"8x8_3":{1:{x:0,y:0},2:{x:7,y:7}}},n=function(e){return{board:t[e],players:o[e]}};return getRandomBoard=function(t,a){var o=[],n={x:0,y:0},r={x:t-1,y:t-1},d=0;for(x=0;t>x;x++)for(o.push([]),y=0;t>y;y++)o[x][y]=e.empty;for(o[n.x][n.y]=e.owned(1),o[r.x][r.y]=e.owned(2);a>d;)x=Math.floor(Math.random()*t),y=Math.floor(Math.random()*t),x===n.x&&y===n.y||x===r.x&&y===r.y||x===n.x+2&&y===n.y+1||x===n.x+1&&y===n.y+2||x===r.x-2&&y===r.y-1||x===r.x-1&&y===r.y-2||o[x][y]===e.dead||(o[x][y]=e.dead,d+=1);return{board:o,players:{1:n,2:r}}},{getBoard:n,getRandomBoard:getRandomBoard}}();t.exports=o},{"./util.js":7}],2:[function(e,t){var a=function(){var e={type:"mostOpenPath"},t={empty:"E",dead:"D",owned:function(e){if(1!==e&&2!==e)throw String("State cannot be "+e+".");return String(e)}},a=function(e,a,o){var n,r=[],d=1===a?o.p1.position:o.p2.position,p=1===a?o.p2.position:o.p1.position,s=[{x:d.x-2,y:d.y-1},{x:d.x-2,y:d.y+1},{x:d.x-1,y:d.y-2},{x:d.x-1,y:d.y+2},{x:d.x+2,y:d.y-1},{x:d.x+2,y:d.y+1},{x:d.x+1,y:d.y-2},{x:d.x+1,y:d.y+2}];for(n=0;n<s.length;n++)move=s[n],move.x>=0&&move.x<e.length&&move.y>=0&&move.y<e.length&&(1===Math.abs(d.x-move.x)&&2===Math.abs(d.y-move.y)||2===Math.abs(d.x-move.x)&&1===Math.abs(d.y-move.y))&&e[move.x][move.y]!==t.dead&&(move.x!==p.x||move.y!==p.y)&&r.push(move);return r},o=function(e,t,o){var n=a(e,t,o),r=Math.floor(Math.random()*n.length);return n[r]},n=function(e,o,n){var r,d=0,p=0,s=a(e,o,n),m=s.filter(function(a,o){return e[s[o].x][s[o].y]!==t.owned(2)});for(console.log(m),0===m.length&&(m=s),r=0;r<m.length;r++){var i=m[r],y=function(){var e={};return e=1===o?{p1:{position:{x:i.x,y:i.y},score:n.p1.score},p2:n.p2}:{p1:n.p1,p2:{position:{x:i.x,y:i.y},score:n.p2.score}}},l=a(e,o,y());l.length>d&&(d=l.length,p=r)}return console.log("BOT: "+m[p]),m[p]},r=function(t){if("random"!==t&&"mostOpenPath"!==t)throw String("Bot cannot be of type: "+t);return e.type=t,!1},d=function(t,a,r){var d;switch(console.log(e.type),e.type){case"random":d=o(t,a,r);break;case"mostOpenPath":d=n(t,a,r);break;default:d=void 0}return d};return{setType:r,getMove:d}};t.exports=a},{}],3:[function(e){var t,a,o=e("./util.js"),n=e("./board.js"),r=e("./gamelogic.js"),d=e("./player.js"),p=e("./bot.js"),s=e("./ui.js"),m={1:null,2:null},i=StateMachine.create({initial:"form",events:[{name:"startGame",from:"form",to:"p1Turn"},{name:"invalidMove",from:"p1Turn",to:"p1Turn"},{name:"invalidMove",from:"p2Turn",to:"p2Turn"},{name:"validMove",from:"p1Turn",to:"p2Turn"},{name:"validMove",from:"p2Turn",to:"p1Turn"},{name:"gameOver",from:["p1Turn","p2Turn"],to:"gameEnded"},{name:"configForm",from:["p1Turn","p2Turn","gameEnded"],to:"form"}]});$(window).on("ui-start-game",function(e,t){i.startGame(t)}),$(window).on("ui-restart-game",function(){i.configForm()}),$(window).on("ui-move",function(e,o){(i.is("p1Turn")||i.is("p2Turn"))&&(r.isValidMove(t,m,a,o)?i.validMove(o):i.invalidMove())});var y=function(){var e=r.isOver(t,m,a);e?i.gameOver(e):(s.setMessage(o.messages.turn(a)),"human"===m[a].type?s.bindBoard():i.validMove(m[a].bot.getMove(t,m,a)))};i.onleaveform=function(e,a,o,r){var i;i="random"===r.boardType?n.getRandomBoard(r.boardSize,r.deadSpaces):n.getBoard(r.boardType),t=i.board,console.log("onleaveform"),"human"===r.p1?(m[1]=new d,m[1].create("human",1,null,i.players[1].x,i.players[1].y)):(m[1]=new d,m[1].create("computer",1,new p,i.players[1].x,i.players[1].y)),"human"===r.p2?(m[2]=new d,m[2].create("human",2,null,i.players[2].x,i.players[2].y)):(m[2]=new d,m[2].create("computer",2,new p,i.players[2].x,i.players[2].y)),s.initialiseBoard(t)},i.onp1Turn=function(){console.log("onp1Turn"),a=1,y()},i.onp2Turn=function(){console.log("onp2turn"),a=2,y()},i.oninvalidMove=function(){console.log("oninvalidmove"),s.setMessage(o.messages.invalidMove(a))},i.onbeforevalidMove=function(e,o,n,d){console.log("onbeforevalidmove"),s.unbindBoard();var p=r.move(t,m,a,d);t=p.board,m=p.players},i.onleavep1Turn=function(){return console.log("onleavep1turn"),s.updateBoard(t,m,function(){i.transition()}),StateMachine.ASYNC},i.onleavep2Turn=function(){return console.log("onleavep2turn"),s.updateBoard(t,m,function(){i.transition()}),StateMachine.ASYNC},i.ongameOver=function(e,a,o,n){console.log("ongameover"),m=n.players,s.updateBoard(t,m,function(){}),s.setMessage(String(n.reason+n.winner))},i.onconfigForm=function(){console.log("onconfigform"),s.toggleForm()}},{"./board.js":1,"./bot.js":2,"./gamelogic.js":4,"./player.js":5,"./ui.js":6,"./util.js":7}],4:[function(e,t){var a=e("./util.js"),o=function(){var e=function(e,t){return t.x>=0&&t.x<e.length&&t.y>=0&&t.y<e.length},t=function(e,t){return 1===Math.abs(e.x-t.x)&&2===Math.abs(e.y-t.y)||2===Math.abs(e.x-t.x)&&1===Math.abs(e.y-t.y)},o=function(t,o,n,r){var d=o[n].position,p=o[a.otherTurn(n)].position;return e(t,r)&&(1===Math.abs(d.x-r.x)&&2===Math.abs(d.y-r.y)||2===Math.abs(d.x-r.x)&&1===Math.abs(d.y-r.y))&&t[r.x][r.y]!==a.state.dead&&!(r.x===p.x&&r.y===p.y)},n=function(t,n,r){console.log(r);var d,p=n[r].position,s=(n[a.otherTurn(r)].position,[]),m=[{x:p.x-2,y:p.y-1},{x:p.x-2,y:p.y+1},{x:p.x-1,y:p.y-2},{x:p.x-1,y:p.y+2},{x:p.x+2,y:p.y-1},{x:p.x+2,y:p.y+1},{x:p.x+1,y:p.y-2},{x:p.x+1,y:p.y+2}];for(d=0;d<m.length;d++){var i=m[d];e(t,i)&&o(t,n,r,i)&&s.push(i)}return s},r=function(e,o,r){var d=o[a.otherTurn(r)];return e[d.position.x][d.position.y]!==a.state.dead&&0!==n(e,o,a.otherTurn(r)).length&&t(d.position,o[r].position)},d=function(e,t,a,o){return a===o?0===n(e,t,o).length:0===n(e,t,o).length&&!r(e,t,o)},p=function(e){var t=!0;for(x=0;x<e.length;x++)for(y=0;y<e.length;y++)if(e[x][y]===a.state.empty){t=!1;break}return t},s=function(e){var t=e[1].score-e[2].score;return 0===t?3:0>t?2:t>0?1:void 0},m=function(e,t,o){var n,r,m=_.cloneDeep(t);return p(e)?{reason:a.messages.gameover.full,players:t,winner:a.messages.winner(s(t))}:(n=d(e,t,o,o),r=d(e,t,o,a.otherTurn(o)),n&&r?{reason:a.messages.gameover.trapped(o+a.otherTurn(o)),players:m,winner:a.messages.winner(s(m))}:n?{reason:a.messages.gameover.trapped(o),players:m,winner:a.messages.winner(s(m))}:r?{reason:a.messages.gameover.trapped(a.otherTurn(o)),players:m,winner:a.messages.winner(s(m))}:!1)},i=function(e,t,n,r){var d=_.cloneDeep(e),p=_.cloneDeep(t);if(o(e,t,n,r)){var s=e[r.x][r.y];switch(s){case a.state.empty:d[r.x][r.y]=a.state.owned(n),p[n].score=p[n].score+1;break;case a.state.owned(a.otherTurn(n)):d[r.x][r.y]=a.state.dead,p[a.otherTurn(n)].score-=1}return p[n].position={x:r.x,y:r.y},{board:d,players:p}}return!1};return{isValidMove:o,availableMoves:n,isOver:m,move:i}}(_);t.exports=o},{"./util.js":7}],5:[function(e,t){var a=function(){var e={x:null,y:null},t=1,a="",o=0,n=null,r=function(e,t,a,o,n){this.type=e,this.turnId=t,this.bot=a,this.position={x:o,y:n}};return{position:e,type:a,turnId:o,bot:n,create:r,score:t}};t.exports=a},{}],6:[function(e,t){var a=function(){var e={dom_boardHolder:"#board-holder",dom_board:"#board",dom_message:"#message",dom_space:".space",dom_config:"#config",dom_game:"#game",dom_newGame:"#new-game",dom_startGame:"#start-game",dom_players:".player",dom_p1score:".score.p1 p",dom_p2score:".score.p2 p",dom_formBoard:"select#boardType",dom_randomBoard:".field.toggleable"},t=function(t){var a,o=$(e.dom_boardHolder),n=$(e.dom_board),r=parseInt(o.css("width")),d=parseInt(o.css("height"));r>=d?(a=Math.floor(d/t)*t,n.css({"margin-left":String((r-a)/2+"px"),"margin-top":"0"})):(a=Math.floor(r/t)*t,n.css({"margin-top":String((d-a)/2+"px"),"margin-left":"0"})),n.css({height:String(a+"px"),width:String(a+"px")})},a=function(a){m();var o,n,r,d=$(e.dom_board),p=a.length;for(n=0;p>n;n++)for(o=0;p>o;o++)r=a[o][n],"E"===r&&d.append("<div class='space empty' data-x='"+o+"' data-y='"+n+"'></div>"),"D"===r&&d.append("<div class='space dead' data-x='"+o+"' data-y='"+n+"'></div>"),("1"===r||"2"===r)&&d.append("<div class='space owned-"+r+"' data-x='"+o+"' data-y='"+n+"'><div class='player' id='p"+r+"'></div></div>");t(p),$(e.dom_space).css({height:String(100/p+"%"),width:String(100/p+"%")}),$(e.dom_newGame).on("click",function(){var e=confirm("Are you sure you want to start a new game?");e&&$(window).trigger("ui-restart-game")})},o=function(t,a,o){for(x=0;x<t.length;x++)for(y=0;y<t.length;y++){var n=t[x][y],r=$('.space[data-x="'+x+'"][data-y="'+y+'"]');"D"===n&&r.removeClass("owned-1").removeClass("owned-2").removeClass("empty").addClass("dead"),"1"===n&&r.removeClass("empty").removeClass("dead").removeClass("owned-2").addClass("owned-1"),"2"===n&&r.removeClass("empty").removeClass("dead").removeClass("owned-1").addClass("owned-2")}$(e.dom_players).remove(),$('.space[data-x="'+a[1].position.x+'"][data-y="'+a[1].position.y+'"]').append("<div class='player' id='p1'></div>"),$('.space[data-x="'+a[2].position.x+'"][data-y="'+a[2].position.y+'"]').append("<div class='player' id='p2'></div>"),$(e.dom_p1score).text(a[1].score),$(e.dom_p2score).text(a[2].score),o()},n=function(t){var a=t.replace(/Player 1/g,"Blue").replace(/Player 2/g,"Yellow");-1!==a.indexOf("Game over")&&alert(a),$(e.dom_message).text(a)},r=function(){var e={x:parseInt($(this).attr("data-x")),y:parseInt($(this).attr("data-y"))};$(window).trigger("ui-move",[e])},d=function(){$(e.dom_space).on("click",r)},p=function(){$(e.dom_space).off("click")},s=function(){var e=$(this).parents("form"),t={boardType:e.find("#boardType").val(),boardSize:parseInt(e.find("#size").val()),deadSpaces:parseInt(e.find("#dead").val()),p1:e.find("#p1").val(),p2:e.find("#p2").val()};$(window).trigger("ui-start-game",[t])},m=function(){$(e.dom_config).hasClass("hidden")?($(e.dom_config).removeClass("hidden"),$(e.dom_game).addClass("hidden"),$(e.dom_space).off("click"),$(e.dom_newGame).off("click"),$(e.dom_board).empty()):($(e.dom_config).addClass("hidden"),$(e.dom_game).removeClass("hidden"))};return $(e.dom_formBoard).on("change",function(){var t=$(e.dom_formBoard).val();"random"===t?$(e.dom_randomBoard).show():$(e.dom_randomBoard).hide()}),$(e.dom_startGame).on("click",s),$(window).on("resize",function(){t(Math.sqrt($(e.dom_space).length))}),{initialiseBoard:a,updateBoard:o,bindBoard:d,unbindBoard:p,setMessage:n,toggleForm:m}}($);t.exports=a},{}],7:[function(e,t){var a=function(){var e={empty:"E",dead:"D",owned:function(e){if(1!==e&&2!==e)throw String("State cannot be "+e+".");return String(e)}},t={newGame:"New game started. Player 1's turn.",invalidMove:function(e){return"Invalid move. Player "+e+"'s turn."},turn:function(e){return"Player "+e+"'s turn."},gameover:{full:"Game over. Board is full.",trapped:function(e){var t="";switch(e){case 1:t="Game over. Player 1 is trapped.";break;case 2:t="Game over. Player 2 is trapped.";break;case 3:t="Game over. Both players are trapped."}return t},cycle:function(e){var t="";switch(e){case 1:t="Game over. Player 1 is trapped in a cycle.";break;case 2:t="Game over. Player 2 is trapped in a cycle.";break;case 3:t="Game over. Both players are trapped in cycles."}return t}},winner:function(e){return 1==e||2==e?" Player "+e+" wins.":3==e?" Game ends in a draw.":!1}},a=function(e){if(1!==e&&2!==e)throw String("TurnID cannot be "+e+".");return 1===e?2:1};return{state:e,otherTurn:a,messages:t}}();t.exports=a},{}]},{},[3]);